# Search Agent

## プロジェクト概要

このSearch Agentは、DuckDuckGo検索エンジンとOpenAIの言語モデルを組み合わせたインテリジェントな検索アシスタントです。ユーザーからの質問に対して、インターネット上の情報を検索し、LLMを活用して適切な回答を生成します。

主な特徴：
- DuckDuckGo検索とOpenAI GPTの統合
- レート制限による安定した検索機能
- 堅牢なエラーハンドリング機能
- 対話的なコマンドラインインターフェース

## 技術アーキテクチャ

### サーバーコンポーネント (search_server.py)
- LangChainフレームワークを使用したエージェントの実装
- DuckDuckGo検索ツールの統合
- レート制限機能の実装
- エラーハンドリングの実装

### クライアントコンポーネント (search_client.py)
- ユーザーインターフェースの提供
- サーバーとの連携
- エラー表示の管理

## 実装の工夫点

### レート制限の実装
- 検索リクエスト間に最小2秒の遅延を設定
- レート制限エラー発生時は5秒待機して自動リトライ
- グローバル変数による最終リクエスト時刻の追跡

### エラーハンドリング
- サーバー層での例外キャッチと適切なエラーメッセージの返却
- クライアント層での例外ハンドリングによるユーザーフレンドリーなエラー表示
- KeyboardInterruptとEOFErrorの適切な処理

### 検索の最適化
- max_iterations=2による検索回数の制限
- handle_parsing_errors=Trueによる解析エラーの適切な処理
- verbose=Trueによるデバッグ情報の表示

## セットアップ手順

1. 必要なパッケージのインストール
```bash
pip install -r requirements.txt
```

2. 環境設定
- `.env.example`を`.env`にコピー
- OpenAI APIキーを設定
```
OPENAI_API_KEY=your-api-key-here
```

## 使用方法

1. サーバーの起動
```bash
python search_client.py
```

2. 検索クエリの入力
- プロンプトに検索したい内容を入力
- 'quit'と入力して終了

### 効果的な検索のヒント
- 具体的で明確な質問を入力
- 複雑な質問は単純な部分に分割
- 検索キーワードは具体的に

## 制限事項と注意点

### レート制限
- 連続した検索は2秒以上の間隔が必要
- レート制限エラー時は自動的に待機

### API利用
- OpenAI APIキーの適切な管理が必要
- APIの利用制限に注意

### 検索結果
- 最大2回の検索イテレーション
- 結果の正確性は入力クエリの質に依存

## 将来の改善可能性

### 機能拡張
- 複数の検索エンジンのサポート
- 検索結果のキャッシング機能
- 非同期処理による高速化

### スケーラビリティ
- 分散システムへの対応
- データベースの導入
- コンテナ化対応

### セキュリティ強化
- APIキーのローテーション機能
- リクエストの認証機能
- 入力値のバリデーション強化
